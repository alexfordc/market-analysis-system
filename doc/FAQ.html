<?php
$headers = getallheaders();
?>
<STYLE TYPE="text/css">
  <!--
  .indented
     {
     padding-left: 20pt;
     padding-right: 20pt;
     }
  -->
</STYLE>
<HTML>
<META NAME=KEYWORDS CONTENT="technical analysis, stock, stocks, Linux,
windows, charting, charts, automated signals, market, Eiffel, Java,
freeware, free software, trading, investing, client/server, market analysis,
open source, moving average, stochastic, MACD, RSI, relative strength index,
on balance volume, technical indicators, buy signal, sell signal,
candlesticks, traders, financial markets, trading tools, subscription">
<HEAD>
<TITLE>Market Analysis System - Frequently Asked Questions</TITLE>
</HEAD>
<BODY bgcolor=#FFFFFF topmargin="0" bottommargin="0" leftmargin="0" rightmargin="0" marginheight="0" marginwidth="0">
<tr>
<td>&nbsp;
<center>
<h2>
Market Analysis System (MAS):  Frequently Asked (or Anticipated) Questions
</h2>
</center>
<DIV CLASS="indented">
<P>
<br><br>
<h3>
Operating the Server
</h3>
<B>Once the server is started in the background, how do I end / stop the
server.  (I have been just using the kill command ie kill -9 procid.)
Is there another way to have the server stop?</B>
<P>
You can stop the server by starting up the command-line client (either
macl - or maclj, if you don't have Python installed but do have Java)
and then entering a Control-E and a newline.  I didn't document this
clearly because it's a potential security risk - if MAS is running on
the internet, anyone can connect and stop the server.  Of course, this
is a little silly (not to document it); probably the best solution is to
add some user verification functionality.
<P><B>
When I change the data files after the server is run, it will not 
pick up any newly named files.  (For example, if ibm.txt and qqq.txt
were listed when I ran the MAS server, and I added nt.txt later, MAS
will not pick up 'nt'.)  Is there any way without resetting (shutdown
and restart) the server for it to pick up the new data files?
<P></B>
Currently, the only way to add new files is to shut down and restart the
server.  The capability to add new tradables while the server is
running is a feature that may be added in the future if there is
enough demand for it.
<P><B>
When I try to download data off the internet using the -w parameter I get a lot
of error messages that look like this: 
<br>Date input value is invalid.
<br>Error occurred after record 871 (with date/time 05/12/2003 12:00:00.0 AM).
<br>Discarding corrupted record.
<P></B>
Since the yahoo data has an open-price field (as I
suppose all data sources do these days), you need to add the -o option when
you start the MAS server.
(The upcoming release defaults to using open fields, so the -o will not
longer be needed.)  Also, the data is saved in comma-separated format,
so you also need to include the option <B><I> -f ',' </I></B>
to specify that the field
separator is a comma.  (Tip: If someone has data in a different format,
such as separated by semi-colons, you can get MAS to read the data with
the option <B><I>-f ';'</I></B>.
[The quotes are needed with UNIX/Linux to protect
the semi-colon from being eaten by the shell.])
<p>
So the easiest way to start it for yahoo data would be something like:
<I>
<P>
mas -f , -o -w 5555
</I>
<P>
(where 5555 is the port number and should be replaced by the port number
you are using).
<h3>
Signal Generation
</h3>
<P><B>
I haven't had much luck with the log file for sending the market analysis -
it produces a core dump when I try and do this.
</B><P>
File logging is broken, apparently due to a bug in the
library component I'm using.
I plan to remove the feature soon, unless I can fix it.
In the meantime, an alternative
is to write a script to filter the MAS
"emails" and put them into a file instead of emailing them.
See the question below about receiving signals without having them
emailed.
<P><B>
Is there anyway to get buy/sell signals without emailing them to
someone - for example, just listing them to STDOUT.
This will allow me
to use the data how I would like in perl or what ever, instead of
perl going to my email and parsing the data.
</B><P>
You can do this by replacing the MAS "mailer" program with a script to
do whatever you want with the signals sent from MAS.
Just write the script to do whatever you want with the data, parsing it
according to the
format that shows up in email messages when MAS uses a regular mailer.
Once you
write the script, you can tell MAS to use it as your mailer by setting
the MAS_MAILER environment variable (documented in the file
env_settings) to the path of the script, making sure it is executable,
of course.
Then use the event registration feature of MAS (from the command-line
client) to register a new user that will receive signals using your
script.
Here's a simple example:
<P>
#!/bin/bash
<P><I>
mas_dir=/path_where_mas_signals_are_stored
<br>
/bin/cat  >> $mas_dir/events$(/bin/date +%Y%m%d)
<P></I>
Of course, you can do more sophisticated filtering, such as putting buy
and sell signals into separate files according to the subject line.
I've written a Python script that adds or removes stock symbols from
watchlists according to whether a signal arrives indicating that the
stock is in a long-term uptrend, downtrend, or is going sideways.
<h3>
Administration and Setup
</h3>
<P><B>
I'm running into problems with MAS not using the new mailer I've set up -
it is still trying to use elm.  I have set the MAS_MAILER variable:
MAS_MAILER=/home/masuser/masconfig/masfilter.
masfilter is executable.
When I do the market analysis study, I get
<I>
sh: elm not found
</I>
(since I do not have elm installed on my machine).
What am I doing wrong?
<P></B>
Most likely you did not export the MAS_MAILER environment variable.
For example, if you are setting the variable in your .profile (or whatever
login initialization file you're using with your bash/sh-compatible shell),
you would add the following line to your .profile file:
<P><I>
export MAS_MAILER=/mailerpath
</I>
<P>
or, for csh-compatible shells:
<P><I>
setenv MAS_MAILER &nbsp;/mailerpath
</I>
<P>
Of course, you also need to export the MAS_DIRECTORY variable if you are
setting it.
<P>
If this is not the problem - if you've already exported the
MAS_MAILER variable, then the problem could be that you are using a user
(event registrant) for your events that was set up with a previous MAS_MAILER
setting.
The design of MAS has an idiosyncrasy where once a user (event registrant)
has been registered, the MAS_MAILER that was set at that point is the
one that is used for that user - it gets saved to a file, and it can't
be edited.
So for that "user" the mailer can't be changed.
The way to
get around this when you change mailers is to delete the original user
and add a new user while running MAS with the MAS_MAILER variable set
to the new mailer, in this case to the path of your script.
<P><B>
I'm running into problems with MAS not using the
MAS_DIRECTORY variable.
I added:
MAS_DIRECTORY=/home/masuser/masconfig/
to my .profile.
But MAS doesn't use the indicators and other settings
files I've set up in that directory.
What am I doing wrong?
<P></B>
Most likely you did not export the MAS_DIRECTORY environment variable.
See the question above about MAS not using the mailer set up with MAS_MAILER
for an example of how to export an environment variable.
<P><B>
I updated to a new version of MAS and when the server starts up it
prints the following error and exits:
"Retrieval of indicator library file indicators_persist failed.
The file may be corrupted or you may have an incompatible version."
How can I use the old indicators I have created with the new server?
<P></B>
This problem occurs when a new version of MAS incorporates a change to
the structure of the indicator code that is not compatible with the old
version.  As a result, the old indicator file, indicators_persist, cannot
be loaded when the new version of the server starts up.  Once this occurs,
the only way to use your old indicators is to keep using the old version
of the server.  However, there is a preventative method that can be
used to overcome the problem: Whenever you create a new indicator, start
the server in the background (-b option) and use the command-line client
program, macl, to talk to the server and "record" the conversation with
the command:
<P><I>
macl -r output_file &lt;portnumber&gt;
<P></I>
where
<I>
output_file
</I>
is the name of the file to which you wish to save the recorded output
and
<I>
&lt;portnumber&gt;
</I>
is the port number with which you started the server.
Keep this file in a safe place.  It would probably also be a good idea
to keep it backed up.
<P>
Whenever you upgrade to a new version of MAS and get the above error
message, you can restore the indicators you have created by running
the following command on each of your recorded output files:
<P><I>
macl -i file &lt;portnumber&gt;
<P></I>
where
<I>
file
</I>
is the name of a file created earlier with the -r option
and
<I>
&lt;portnumber&gt;
</I>
is, again, the port number with which you started the server.
<h3>
Data-related Problems
</h3>
<P><B>
I'm getting the following error from the server:
<P>
Error occurred while reading /home/user/data/x.txt: I/O error.
<br>
Error encountered - obtaining data for GUI client:
<br>
Routine failure.
<br>
Fatal error: Error occurred retrieving trading period types for x.
<br>
Exiting ...
<P>
Everything looks OK to me - the permissions on the file and the directory
that contains it are correct;
the content and format of x.txt looks correct.
What is going wrong?
<P></B>
The problem is most likely that the data in x.txt is reversed.
Some programs output data in the opposite order that MAS expects, with the
latest date at the beginning of the file and the earliest date at the end.
MAS wants the latest date at the end and the earliest date at the beginning.
You can use the following script to reverse the order of the lines in a
data file:
<P><I><TT>
#!/usr/bin/env bash
<br>
#  Reverse the order of lines in infile and output the result to outfile.
<br>
<br>
pname=$(basename $0)
<br>
<br>
usage() {
<br>
&nbsp;&nbsp;&nbsp;&nbsp;echo "Usage: $pname infile outfile"
<br>
}
<br>
<br>
if [ $# -ne 2 ]; then
<br>
&nbsp;&nbsp;&nbsp;&nbsp;usage; exit 1
<br>
fi
<br>
<br>
awk '{
<br>
&nbsp;&nbsp;&nbsp;&nbsp;lines[i++] = $0
<br>
} END {
<br>
&nbsp;&nbsp;&nbsp;&nbsp;for (j = i - 1; j >= 0; --j) {
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print lines[j]
<br>
&nbsp;&nbsp;&nbsp;&nbsp;}
<br>
}' $1 > $2
<P></I></TT>
<h3>
Database Problems
</h3>
<B>
I get this error when I start MAS using my odbc database connection: 
"Error occurred retrieving non-intraday period types for a" (a being the first stock symbol 
on my list). This answer covers some other SQL errors as well.
<P></B>
Possible solutions are as follows:
<UL>
<LI>
Make sure your stock symbols are all in lowercase.
MAS currently has a bug that causes upper case symbols to not be handled
correctly.
(Alternatively, you can use a function to
convert to lower case in the symbol query specified in your mas_dbrc file
and use the <I>&lt;uppersymbol&gt;</I> construct in your data query if
the query uses the symbol as a key; see the comments in the mas_dbrc file
for how to use <I>&lt;uppersymbol&gt;</I>.)
<LI>
Make sure there are no trailing characters after your symbols, if you are
using a postgres database make sure the symbols are in a varchar field,
not a char field since char fields will pad with spaces and leave trailing
spaces in a query.
<LI>
If all that seems to be right and you still get errors, make sure that
the stock quotes are in the correct fields of the database (e.g., closing
price is in the closing field of the query, etc).
<LI>
If you use the date type for the date field in the database, make sure
your dates are returned in the format YYYYMMDD; if you are using
PostgreSQL with a standard installation it will probably return them in the
YYYY-MM-DD format, so you can use a to_char(date, 'YYYYMMDD') in your
query to convert them to a MAS supported format.  (Some database systems
may have a date-to-integer conversion function, which will likely also
work, as long as the result is in YYYYMMDD format.)
</UL>
<!-- Include this when version 1.7 is released:
<h3>
Debugging
</h3>
<P><B>
When I use the debugging option and print a moving average indicator, the
debug output shows that the value of the LINEAR_SUM operator is always the
same, from the first record to the last.  Is this a bug?
<P></B>
No, it's not a bug.  The main moving average functions, Simple Moving 
Average and Exponential Moving Average, are optimized to only use the
LINEAR_SUM operator to produce the first output record.  Thus, since it
is only executed one time, the LINEAR_SUM operator's value will remain
the same throughout a run.
-->
</BODY>
