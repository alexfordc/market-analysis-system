#!/usr/bin/env bash
# Market Analysis GUI Client (MAGC)

Progname=$(basename $0)
basedir=$(dirname $0)/..
classdir=$basedir/lib/classes

usage() {
	echo "Usage: $pname [cl] [no_cd] [-h hostname] port_number"
	echo "where:"
	echo "   cl = run command-line client instead of GUI"
	echo "   no_cd = do not change directories - stay in the current directory"
}

check_settings() {
	if [ ! -d $classdir -o ! -x $classdir ]; then
		echo "$Progname: Cannot access class directory: $classdir" >&2
		exit -1
	fi
	if [ ! -r ${classdir}/${main}.class ]; then
		echo "$Progname: Cannot access java class file: " \
				"${classdir}/${main}.class" >&2
		exit -1
	fi
}

host=$(hostname)
main=MA_Client
while [ $# -gt 0 ]
do
	case $1 in
		cl) main=CL_Client; shift ;;
		n*) no_cd=true; shift ;;
		-h) shift; host=$1; shift ;;
		-*) usage; exit 0 ;;
		*) port_number=$1; shift ;;
	esac
done

if [ -z "$port_number" ]; then
	usage
	exit -1
fi

check_settings
if [ "$no_cd" = true ]; then
	export CLASSPATH=$classdir
else
	cd $classdir
fi
java $main $host $port_number
